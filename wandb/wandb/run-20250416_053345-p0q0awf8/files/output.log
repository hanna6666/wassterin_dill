[36m[INFO] CONFIG:
DATASET:
  INPUT_SIZE: 224
  NUM_CLASSES: 1000
  NUM_WORKERS: 8
  PREFETCH: false
  TEST:
    BATCH_SIZE: 256
  TYPE: imagenet
DISTILLER:
  STUDENT: ResNet18
  TEACHER: ResNet34
  TYPE: WKD
EXPERIMENT:
  NAME: ''
  PROJECT: imagenet_baselines
  SEED: 0
  TAG: wkd_l,res34,res18
LOG:
  PREFIX: ''
  SAVE_CHECKPOINT_FREQ: 20
  TENSORBOARD_FREQ: 10
  WANDB: true
SOLVER:
  BATCH_SIZE: 256
  EPOCHS: 100
  LR: 0.1
  LR_DECAY_RATE: 0.1
  LR_DECAY_STAGES:
  - 30
  - 60
  - 90
  MOMENTUM: 0.9
  TRAINER: base
  TYPE: SGD
  WEIGHT_DECAY: 0.0001
WKD:
  COST_MATRIX: cka
  COST_MATRIX_PATH: wkd_cost_matrix/imagenet/ResNet34/logit_linear_cka.pth
  COST_MATRIX_SHARPEN: 1.0
  EPS: 1.0e-05
  HINT_LAYER: 4
  INPUT_SIZE:
  - 224
  - 224
  LOSS:
    CE_WEIGHT: 1.0
    COSINE_DECAY_EPOCH: 0
    WKD_FEAT_WEIGHT: 0.0
    WKD_LOGIT_WEIGHT: 30.0
  MEAN_COV_RATIO: 2.0
  PROJECTOR: bottleneck
  SINKHORN:
    ITER: 10
    LAMBDA: 0.05
  SPATIAL_GRID: 4
  TEMPERATURE: 2.0
[0m
input_size:  224
Traceback (most recent call last):
  File "/content/drive/MyDrive/WKD/tools/train.py", line 186, in <module>
    main(cfg, args.resume, args.opts)
  File "/content/drive/MyDrive/WKD/tools/train.py", line 97, in main
    train_loader, val_loader, num_data = get_imagenet_dataloaders(
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/drive/MyDrive/WKD/tools/train.py", line 37, in get_imagenet_dataloaders
    train_set = ImageNet(train_folder, transform=train_transform)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/drive/MyDrive/WKD/mdistiller/dataset/imagenet.py", line 12, in __init__
    super().__init__(root, transform=transform, target_transform=target_transform)
  File "/usr/local/lib/python3.11/dist-packages/torchvision/datasets/folder.py", line 328, in __init__
    super().__init__(
  File "/usr/local/lib/python3.11/dist-packages/torchvision/datasets/folder.py", line 149, in __init__
    classes, class_to_idx = self.find_classes(self.root)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torchvision/datasets/folder.py", line 234, in find_classes
    return find_classes(directory)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torchvision/datasets/folder.py", line 41, in find_classes
    classes = sorted(entry.name for entry in os.scandir(directory) if entry.is_dir())
                                             ^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/imagenet/train'
